---
title: "Projeto ME812"
output: html_notebook
---

Estudo qualitativo-quantitativo de florestas sagradas em Moçambique

Lembrete: Se certificar que está na pasta correta, que contém os dados com getwd() e na hora de salvar usar UTF-8

Bibliotecas
Inserir aqui as bibliotecas necessárias (se não tiver no pc, instalar antes)
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
library(readxl)
library(dplyr)
library(ggplot2)
library(ggpubr)
```

```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
Sys.setlocale("LC_ALL", "en_US.UTF-8")
```

Dados

```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
q1 <- read_excel("Q1_ Perfil dos Entrevistados.xlsx", sheet = 1)
q2 <- read_excel("Q2_ Nome vulgar da Mata e Sacralidade.xlsx", sheet = 1) # engloba totalmente q1
q3 <- read_excel("Q3_ Propriedade e Responsabilidade pela Gestão da Mata.xlsx", sheet = 1)
q4 <- read_excel("Q4_ Estado de conservação e Critérios.xlsx", sheet = 1)
q4_1 <- read_excel("Q4_1 Estado de Conservação_ Risco de desaparacimento.xlsx", sheet = 1)
q5 <- read_excel("Q5_ Serviços Ecossistêmicos.xlsx", sheet = 1)
q5_1 <- read_excel("Q5_1 Serviços Ecossistêmicos _Tendência da Qualidade.xlsx", sheet = 1)
q5_2 <- read_excel("Q5_2 Serviços Ecossistêmicos Potenciais (Animais).xlsx", sheet = 1)
q5_3 <- read_excel("Q5_3 Serviços Ecossistêmicos Potenciais (Plantas).xlsx", sheet = 1)
q6 <- read_excel("Q6_  Conhecimento Sobre as Instituições.xlsx", sheet = 1)
q6_1 <- read_excel("Q6_ 1 Eficiência das Instituições.xlsx", sheet = 1)
q6_2 <- read_excel("Q6_ 2 Sanções.xlsx", sheet = 1)
```

Junção de todos os dados em uma única tabela

```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
tb <- q1 %>% 
  left_join(q2, by = "Id", suffix = c("", ".REPETIDO10")) %>% 
  left_join(q3, by = "Id", suffix = c("", ".REPETIDO1")) %>% 
  left_join(q4, by = "Id", suffix = c("", ".REPETIDO2")) %>%
  left_join(q4_1, by = "Id", suffix = c("", ".REPETIDO3")) %>%
  left_join(q5, by = "Id", suffix = c("", ".REPETIDO4")) %>%
  left_join(q5_1, by = "Id", suffix = c("", ".REPETIDO5")) %>%
  left_join(q5_2, by = "Id", suffix = c("", ".REPETIDO6")) %>%
  left_join(q5_3, by = "Id", suffix = c("", ".REPETIDO7")) %>%
  left_join(q6, by = "Id", suffix = c("", ".REPETIDO8")) %>%
  left_join(q6_1, by = "Id", suffix = c("", ".REPETIDO9")) %>%
  left_join(q6_2, by = "Id", suffix = c("", ".REPETIDO0"))
  

tb <- tb[,!grepl("REPETIDO", names(tb))]

tb <- tb[, -c(23, 24)] # repetidos 

saveRDS(tb, file = "tabela")

rm(q1, q2, q3, q4, q4_1, q5, q5_1, q5_2, q5_3, q6, q6_1, q6_2)
```

Ler dados já pronto
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
tb <- readRDS("tabela")

head(tb)
```

Mudando str do banco de dados
Rodar apenas 1 vez
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
tb$Sistema <- as.factor(tb$Sistema)
tb$Sexo <- as.factor(tb$Sexo)
tb$`Há (mais ou menos) quanto tempo conhece a mata ?` <- as.numeric(tb$`Há (mais ou menos) quanto tempo conhece a mata ?`) # há valores SR que foram transformados em NA
tb$`Total de critérios mencionados` <- ifelse(tb$`Total de critérios mencionados`=="?",0,tb$`Total de critérios mencionados`)
tb$`Total de critérios mencionados` <- as.numeric(tb$`Total de critérios mencionados`)

tb$`Como avalia o estado de conservação daquele lugar?` <- ifelse(tb$`Como avalia o estado de conservação daquele lugar?`=="?", NA, tb$`Como avalia o estado de conservação daquele lugar?`)

tb$`Como avalia o estado de conservação daquele lugar?` <- ifelse(tb$`Como avalia o estado de conservação daquele lugar?`=="Menos conservada do que antes", "Pior que antes", tb$`Como avalia o estado de conservação daquele lugar?`)

tb$`Como avalia o estado de conservação daquele lugar?` <- ifelse(tb$`Como avalia o estado de conservação daquele lugar?`=="Menos mal conservada do que antes" | tb$`Como avalia o estado de conservação daquele lugar?`=="Melhor conservada do que antes", "Melhor que antes", tb$`Como avalia o estado de conservação daquele lugar?`)

tb$`Como avalia o estado de conservação daquele lugar?` <- as.factor(tb$`Como avalia o estado de conservação daquele lugar?`)

tb$`Reconhece Sacralidade?` <- as.factor(tb$`Reconhece Sacralidade?`)
# Critérios
# for(i in 14:20) {
#   tb[,i] <- as.factor(tb[,i])
# }

tb$Ocupação <- ifelse(tb$Ocupação=="Agricultura" | tb$Ocupação=="Agricultora", "Agricultura familiar", tb$Ocupação)
tb$Ocupação <- as.factor(tb$Ocupação)

tb$`Quem e o dono da mata?` <- as.factor(tb$`Quem e o dono da mata?`)
tb$`Quem cuida da mata?` <- ifelse(tb$`Quem cuida da mata?`=="Comunidade em Geral", "Comunidade em geral", tb$`Quem cuida da mata?`)
tb$`Quem cuida da mata?` <- as.factor(tb$`Quem cuida da mata?`)

```

#Perfil dos entrevistados

##*Sexo*
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
maxVar <- max(table(tb$Sexo))

ggplot(tb, aes(Sexo, fill = Sexo)) +
  geom_histogram(stat="count") +
  ylab("Frequência") +
  scale_fill_manual(labels = c("Feminino", "Masculino"), 
                    values=c( "#FFA8A8", "#86BCFF", "#72FE95", "#FFFF84", "#FFB347")) +
  # theme(legend.position = "none") +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(tb)*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+5) +
  ggtitle("Sexo dos entrevistados")
```

##*Dividido por Sistemas*
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
maxVar <- max(table(subset(tb, tb$Sistema==levels(tb$Sistema)[1])$Sexo))
g1 <- ggplot(subset(tb, tb$Sistema==levels(tb$Sistema)[1]), aes(Sexo, fill = Sexo)) +
  geom_histogram(stat="count") +
  ylab("") +
  scale_fill_manual(labels = c("Feminino", "Masculino"), 
                    values=c( "#FFA8A8", "#86BCFF", "#72FE95", "#FFFF84", "#FFB347")) +
  theme(axis.title.x = element_blank(),
        legend.position = "none") +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(subset(tb, tb$Sistema==levels(tb$Sistema)[1]))*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+20) +
  ggtitle(levels(tb$Sistema)[1])

maxVar <- max(table(subset(tb, tb$Sistema==levels(tb$Sistema)[2])$Sexo))
g2 <- ggplot(subset(tb, tb$Sistema==levels(tb$Sistema)[2]), aes(Sexo, fill = Sexo)) +
  geom_histogram(stat="count") +
  ylab("Frequência") +
  scale_fill_manual(labels = c("Feminino", "Masculino"), 
                    values=c( "#FFA8A8", "#86BCFF", "#72FE95", "#FFFF84", "#FFB347")) +
  theme(axis.title.x = element_blank(),
        legend.position = "none") +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(subset(tb, tb$Sistema==levels(tb$Sistema)[2]))*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+20) +
  ggtitle(levels(tb$Sistema)[2])

maxVar <- max(table(subset(tb, tb$Sistema==levels(tb$Sistema)[3])$Sexo))
g3 <- ggplot(subset(tb, tb$Sistema==levels(tb$Sistema)[3]), aes(Sexo, fill = Sexo)) +
  geom_histogram(stat="count") +
  ylab("") +
  scale_fill_manual(labels = c("Feminino", "Masculino"), 
                    values=c( "#FFA8A8", "#86BCFF", "#72FE95", "#FFFF84", "#FFB347")) +
  theme(legend.position = "bottom") +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(subset(tb, tb$Sistema==levels(tb$Sistema)[3]))*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+20) +
  ggtitle(levels(tb$Sistema)[3])

ggarrange(g1, g2, g3, nrow = 3, ncol = 1, heights = c(1, 1, 1.8))

```

##*Idade*
Faixa 1: 18-30;
Faixa 2: 30-50;
Faixa 3: 50 +
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
tb$FaixaIdade <- NA
tb$FaixaIdade <- ifelse(tb$Idade<30, 1, 2)
tb$FaixaIdade <- ifelse(tb$Idade>50, 3, tb$FaixaIdade)
tb$FaixaIdade <- as.factor(tb$FaixaIdade)

ggplot(tb, aes(Idade, fill = FaixaIdade)) +
  geom_histogram(stat="count") +
  ylab("Frequência") +
  scale_fill_manual(labels = c("18-30", "31-54", "55 ou mais"), 
                    values=c( "#FFA8A8", "#D97BFD", "#86BCFF", "#72FE95", "#FFFF84", "#FFB347")) +
  # theme(legend.position = "none") +
  ggtitle("Idade dos entrevistados")
```

```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
summary(tb$Idade)
```

```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
maxVar <- max(table(tb$FaixaIdade))

ggplot(tb, aes(FaixaIdade, fill = FaixaIdade)) +
  geom_histogram(stat="count") +
  ylab("Frequência") +
  scale_fill_manual(labels = c("18-30", "31-54", "55 ou mais"), 
                    values=c( "#FFA8A8", "#D97BFD", "#86BCFF", "#72FE95", "#FFFF84", "#FFB347")) +
  # theme(legend.position = "none") +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(tb)*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+5) +
  ggtitle("Idade dos entrevistados")
```

##*Dividido por Sistemas*
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
maxVar <- max(table(subset(tb, tb$Sistema==levels(tb$Sistema)[1])$FaixaIdade))
g1 <- ggplot(subset(tb, tb$Sistema==levels(tb$Sistema)[1]), aes(FaixaIdade, fill = FaixaIdade)) +
  geom_histogram(stat="count") +
  ylab("") +
  scale_fill_manual(labels = c("18-30", "31-54", "55 ou mais"), 
                    values=c( "#FFA8A8", "#D97BFD", "#86BCFF", "#72FE95", "#FFFF84", "#FFB347")) +
  theme(axis.title.x = element_blank(),
        legend.position = "none") +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(subset(tb, tb$Sistema==levels(tb$Sistema)[1]))*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+20) +
  ggtitle(levels(tb$Sistema)[1])

maxVar <- max(table(subset(tb, tb$Sistema==levels(tb$Sistema)[2])$FaixaIdade))
g2 <- ggplot(subset(tb, tb$Sistema==levels(tb$Sistema)[2]), aes(FaixaIdade, fill = FaixaIdade)) +
  geom_histogram(stat="count") +
  ylab("Frequência") +
  scale_fill_manual(labels = c("18-30", "31-54", "55 ou mais"), 
                    values=c( "#FFA8A8", "#D97BFD", "#86BCFF", "#72FE95", "#FFFF84", "#FFB347")) +
  theme(axis.title.x = element_blank(),
        legend.position = "none") +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(subset(tb, tb$Sistema==levels(tb$Sistema)[2]))*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+20) +
  ggtitle(levels(tb$Sistema)[2])

maxVar <- max(table(subset(tb, tb$Sistema==levels(tb$Sistema)[3])$FaixaIdade))
g3 <- ggplot(subset(tb, tb$Sistema==levels(tb$Sistema)[3]), aes(FaixaIdade, fill = FaixaIdade)) +
  geom_histogram(stat="count") +
  ylab("") +
  scale_fill_manual(labels = c("18-30", "31-54", "55 ou mais"), 
                    values=c( "#FFA8A8", "#D97BFD", "#86BCFF", "#72FE95", "#FFFF84", "#FFB347")) +
  theme(legend.position = "bottom") +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(subset(tb, tb$Sistema==levels(tb$Sistema)[3]))*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+20) +
  ggtitle(levels(tb$Sistema)[3])

ggarrange(g1, g2, g3, nrow = 3, ncol = 1, heights = c(1, 1, 1.8))
```

##*Ocupação*
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
positions <- c("Agricultura\nfamiliar","Outra","Aposentado","Desempregado","Extrativismo","Medicina\ntradicional","Funcionario do\nSector Privado","Autoridade\ntradicional","Estudante","Funcionario\npúblico","Pesca\nartesanal","Terceiro\nsector","Liderança\nComunitária")

levels(tb$Ocupação) <- gsub(" ", "\n", levels(tb$Ocupação))
levels(tb$Ocupação)[7] <- "Funcionario do\nSector Privado"

maxVar <- max(table(tb$Ocupação))

ggplot(tb, aes(Ocupação, fill = Ocupação)) +
  geom_histogram(stat="count") +
  scale_x_discrete(limits = positions, drop = FALSE) +
  ylab("Frequência") +
  #scale_fill_manual(labels = c("18-30", "31-54", "55 ou mais"), 
                    #values=c( "#FFA8A8", "#D97BFD", "#86BCFF", "#72FE95", "#FFFF84", "#FFB347")) +
  theme(legend.position = "none", axis.text.x = element_text(angle=90, vjust = 0.5, hjust = 1)) +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(tb)*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+5) +
  ggtitle("Ocupação dos entrevistados")
```

##*Estado de conservação*
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}

conservacao <- tb[1,c(16:22)]
conservacao$`Engajamento da comunidade e frequência de visitações` <- sum(as.numeric(tb$`Engajamento da comunidade e frequência de visitações`), na.rm = TRUE)
conservacao$`Respeito às instituições` <- sum(as.numeric(tb$`Respeito às instituições`), na.rm = TRUE)
conservacao$Limpeza <- sum(as.numeric(tb$Limpeza), na.rm = TRUE)
conservacao$`Existência de símbolos o sagrado` <- sum(as.numeric(tb$`Existência de símbolos o sagrado`), na.rm = TRUE)
conservacao$`Tamanho do fragmento` <- sum(as.numeric(tb$`Tamanho do fragmento`), na.rm = TRUE)
conservacao$Outro <- sum(as.numeric(tb$Outro), na.rm = TRUE)
conservacao$`Árvores, animais e água` <- sum(as.numeric(tb$`Árvores, animais e água`), na.rm = TRUE)

conservacao <- as.data.frame(t(conservacao))
conservacao$Critério <- rownames(conservacao)
conservacao$Critério <- as.factor(conservacao$Critério)

positions <- c("Limpeza","Respeito\nàs\ninstituições","Outro","Árvores,\nanimais\ne\nágua","Engajamento\nda\ncomunidade\ne\nfrequência\nde\nvisitações","Tamanho\ndo\nfragmento","Existência\nde\nsímbolos\no\nsagrado")

levels(conservacao$Critério) <- gsub(" ", "\n", levels(conservacao$Critério))

maxVar <- max(conservacao$V1)

ggplot(conservacao, aes(x = Critério, y = V1, fill = Critério)) + 
  geom_bar(stat = "identity") +
  scale_x_discrete(limits = positions, drop = FALSE) +
  ylab("Frequência") +
  theme(legend.position = "none", axis.text.x = element_text(angle=0)) +
  geom_text(stat="identity", aes(label=paste0(round(V1/nrow(tb)*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+5) +
  ggtitle("Critérios de estado de conservação")

```

Dono da mata
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
positions <- c("Guardiões", "Não\nSabe", "Comunidade\nlocal", "Autoridades\nlocais e\nGuardiões", "Entidade\nMistica", "Não\nexiste")

levels(tb$`Quem e o dono da mata?`) <- gsub(" ", "\n", levels(tb$`Quem e o dono da mata?`))
levels(tb$`Quem e o dono da mata?`)[1] <- "Autoridades\nlocais e\nGuardiões"

maxVar <- max(table(tb$`Quem e o dono da mata?`))

ggplot(tb, aes(`Quem e o dono da mata?`, fill = `Quem e o dono da mata?`)) + 
  geom_histogram(stat="count") +
  scale_x_discrete(limits = positions, drop = FALSE) +
  ylab("Frequência") +
  theme(legend.position = "none", axis.text.x = element_text(angle=0)) +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(tb)*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+5) +
  ggtitle("Dono da mata")
```

Quem cuida da Mata Sagrada de Chilaulene
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
levels(tb$`Quem cuida da mata?`) <- gsub(" ", "\n", levels(tb$`Quem cuida da mata?`))

# Arrumando nivel para grafico
levels(tb$`Quem cuida da mata?`)[which(levels(tb$`Quem cuida da mata?`)=="O\ngoverno\ne\n\nComunidade\nem\ngeral")] <- "Governo e a\ncomunidade\nem geral"

levels(tb$`Quem cuida da mata?`)[which(levels(tb$`Quem cuida da mata?`)=="O\ngoverno\ne\na\ncomunidade\n\nem\ngeral")] <- "Governo e a\ncomunidade\nem geral"

levels(tb$`Quem cuida da mata?`)[which(levels(tb$`Quem cuida da mata?`)=="Governo\ne\na\ncomunidade\nem\ngeral")] <- "Governo e a\ncomunidade\nem geral"

levels(tb$`Quem cuida da mata?`)[which(levels(tb$`Quem cuida da mata?`)=="Criadores\nde\ngado")] <- "Criadores\nde gado"

levels(tb$`Quem cuida da mata?`)[which(levels(tb$`Quem cuida da mata?`)=="Comunidade\nem\ngeral")] <- "Comunidade\nem geral"

positions <- names(sort(table(subset(tb, tb$Sistema==levels(tb$Sistema)[1])$`Quem cuida da mata?`), decreasing = TRUE))[1:7]

maxVar <- max(table(subset(tb, tb$Sistema==levels(tb$Sistema)[1])$`Quem cuida da mata?`))

ggplot(subset(tb, tb$Sistema==levels(tb$Sistema)[1]), aes(`Quem cuida da mata?`, fill = `Quem cuida da mata?`)) + 
  geom_histogram(stat="count") +
  scale_x_discrete(limits = positions, drop = FALSE) +
  ylab("Frequência") +
  theme(legend.position = "none", axis.text.x = element_text(angle=0)) +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(subset(tb, tb$Sistema==levels(tb$Sistema)[1]))*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+5) +
  ggtitle("Quem cuida da Mata Sagrada de Chilaulene")
```

Quem cuida da Mata Sagrada de Chirindzene
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
positions <- names(sort(table(subset(tb, tb$Sistema==levels(tb$Sistema)[2])$`Quem cuida da mata?`), decreasing = TRUE))[1:8]

maxVar <- max(table(subset(tb, tb$Sistema==levels(tb$Sistema)[2])$`Quem cuida da mata?`))

ggplot(subset(tb, tb$Sistema==levels(tb$Sistema)[2]), aes(`Quem cuida da mata?`, fill = `Quem cuida da mata?`)) + 
  geom_histogram(stat="count") +
  scale_x_discrete(limits = positions, drop = FALSE) +
  ylab("Frequência") +
  theme(legend.position = "none", axis.text.x = element_text(angle=0)) +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(subset(tb, tb$Sistema==levels(tb$Sistema)[2]))*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+5) +
  ggtitle("Quem cuida da Mata Sagrada de Chirindzene")
```

Quem cuida da Mata Sagrada de Zongoene
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
positions <- names(sort(table(subset(tb, tb$Sistema==levels(tb$Sistema)[3])$`Quem cuida da mata?`), decreasing = TRUE))[1:16]

maxVar <- max(table(subset(tb, tb$Sistema==levels(tb$Sistema)[2])$`Quem cuida da mata?`))

ggplot(subset(tb, tb$Sistema==levels(tb$Sistema)[3]), aes(`Quem cuida da mata?`, fill = `Quem cuida da mata?`)) + 
  geom_histogram(stat="count") +
  scale_x_discrete(limits = positions, drop = FALSE) +
  ylab("Frequência") +
  theme(legend.position = "none", axis.text.x = element_text(angle=0)) +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(subset(tb, tb$Sistema==levels(tb$Sistema)[3]))*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+5) +
  ggtitle("Quem cuida da Mata Sagrada de Zongoene")
```

Sacralidade
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
positions <- names(sort(table(tb$`Reconhece Sacralidade?`), decreasing = TRUE))

maxVar <- max(table(tb$`Reconhece Sacralidade?`))

ggplot(tb, aes(`Reconhece Sacralidade?`, fill = `Reconhece Sacralidade?`)) + 
  geom_histogram(stat="count") +
  scale_x_discrete(limits = positions, drop = FALSE) +
  ylab("Frequência") +
  theme(legend.position = "none", axis.text.x = element_text(angle=0)) +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(tb)*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+5) +
  ggtitle("Sacralidade")
```

```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
faixasIdade <- c("18-30", "31-54", "55 ou mais")

positions <- names(sort(table(subset(tb, tb$FaixaIdade==1)$`Reconhece Sacralidade?`), decreasing = TRUE))

maxVar <- max(table(subset(tb, tb$FaixaIdade==1)$`Reconhece Sacralidade?`))

g1 <- ggplot(subset(tb, tb$FaixaIdade==1), aes(`Reconhece Sacralidade?`, fill = `Reconhece Sacralidade?`)) +
  geom_histogram(stat="count") +
  scale_x_discrete(limits = positions, drop = FALSE) +
  ylab("") +
  theme(axis.title.x = element_blank(), 
        legend.position = "none", 
        axis.text.x = element_text(angle=0)) +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(subset(tb, tb$FaixaIdade==1))*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+20) +
  ggtitle(faixasIdade[1])

maxVar <- max(table(subset(tb, tb$FaixaIdade==2)$`Reconhece Sacralidade?`))

g2 <- ggplot(subset(tb, tb$FaixaIdade==2), aes(`Reconhece Sacralidade?`, fill = `Reconhece Sacralidade?`)) +
  geom_histogram(stat="count") +
  scale_x_discrete(limits = positions, drop = FALSE) +
  ylab("Frequência") +
  scale_fill_discrete(drop = FALSE) +
  theme(axis.title.x = element_blank(), 
        legend.position = "none", 
        axis.text.x = element_text(angle=0)) +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(subset(tb, tb$FaixaIdade==2))*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+20) +
  ggtitle(faixasIdade[2])

maxVar <- max(table(subset(tb, tb$FaixaIdade==3)$`Reconhece Sacralidade?`))

g3 <- ggplot(subset(tb, tb$FaixaIdade==3), aes(`Reconhece Sacralidade?`, fill = `Reconhece Sacralidade?`)) +
  geom_histogram(stat="count") +
  scale_x_discrete(limits = positions, drop = FALSE) +
  ylab("") +
  scale_fill_discrete(drop = FALSE) +
  theme(legend.position = "none", 
        axis.text.x = element_text(angle=0)) +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(subset(tb, tb$FaixaIdade==3))*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+20) +
  ggtitle(faixasIdade[3])

ggarrange(g1, g2, g3, nrow = 3, ncol = 1, heights = c(1, 1, 1.2))

```

Estado de Conservação
```{r, echo=FALSE,warning=FALSE,message=FALSE,error=FALSE}
levels(tb$`Como avalia o estado de conservação daquele lugar?`) <- gsub(" ", "\n", levels(tb$`Como avalia o estado de conservação daquele lugar?`))

positions <- names(sort(table(tb$`Como avalia o estado de conservação daquele lugar?`), decreasing = TRUE))

maxVar <- max(table(tb$`Como avalia o estado de conservação daquele lugar?`))

ggplot(tb, aes(`Como avalia o estado de conservação daquele lugar?`, fill = `Como avalia o estado de conservação daquele lugar?`)) + 
  geom_histogram(stat="count") +
  scale_x_discrete(limits = positions, drop = FALSE) +
  labs(fill='Estado') +
  ylab("Frequência") +
  theme(legend.position = "none", axis.text.x = element_text(angle=0)) +
  geom_text(stat="count", aes(label=paste0(round(..count../nrow(tb)*100,2),"%")), position=position_dodge(width=0.9), vjust=-0.25) +
  ylim(0, maxVar+5) +
  ggtitle("Sacralidade") 
```

